<!DOCTYPE html>
<html lang="en-us">
  <head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  <meta name="author" content="ash">
  
  
  
  <link rel="prev" href="https://ash-z01.github.io/2020/boolandcondition/" />
  <link rel="next" href="https://ash-z01.github.io/2021/cap/" />
  <link rel="canonical" href="https://ash-z01.github.io/2020/recursion/" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
       
       
           Recursion of Lambda-Calculus | Rubik Cell Space
       
  </title>
  <meta name="title" content="Recursion of Lambda-Calculus | Rubik Cell Space">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  
  
 

<script type="application/ld+json">
 "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "https:\/\/ash-z01.github.io\/"
    },
    "articleSection" : "posts",
    "name" : "Recursion of Lambda-Calculus",
    "headline" : "Recursion of Lambda-Calculus",
    "description" : "从前有座山，山里有座庙，庙里有个老和尚，正在给小和尚讲故事呢！故事是什么呢？“从前有座山，山里有座庙，庙里有个老和尚，正在给小和尚讲故事呢！故事是什么呢？‘从前有座山，山里有座庙，庙里有个老和尚，正在给小和尚讲故事呢！故事是什么呢？……’”\n 0x01 不动点 定义函数 𝑓:ℝ↦ℝ，如果 ∃𝑥∈𝐷(𝑓)，使得 𝑥=𝑓(𝑥)，则称点 𝑥 是函数 𝑓(𝑥) 的不动点.\n\/\/ 等式 x = f(x) 可以进行如下的无穷变换 x = f(x) = f(f(x)) = f(f(f(x))) = ... 0x02 递归  递归的强大之处在于它允许用户用有限的语句描述无限的对象! 瑞士的计算机科学家 尼克劳斯·维尔特 如是说..\n 考虑一下 阶乘函数 fact 的定义:\nfact n = 1 if n == 0 else (n * fact (n-1)) \/\/ 尝试进行 lambda 抽象 [忽略表达式的细节] let zero? = lambda n x y . if-then-else (n == 0) x y let pred = lambda x .",
    "inLanguage" : "en-us",
    "author" : "ash",
    "creator" : "ash",
    "publisher": "ash",
    "accountablePerson" : "ash",
    "copyrightHolder" : "ash",
    "copyrightYear" : "2020",
    "datePublished": "2020-11-23 15:57:10 \u002b0800 CST",
    "dateModified" : "2020-11-23 15:57:10 \u002b0800 CST",
    "url" : "https:\/\/ash-z01.github.io\/2020\/recursion\/",
    "wordCount" : "1473",
    "keywords" : [ "Lambda","λ","λ-演算", "Rubik Cell Space"]
}
</script>

</head>

  


  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="javascript:void(0);" class="theme-switch">
                
                💡
            </a>&nbsp;<a href="https://ash-z01.github.io/">Rubik Cell Space</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
     <div class="container">
        <div class="navbar-header">
            <div>  <a href="javascript:void(0);" class="theme-switch">
                
                🐾
                </a>&nbsp;<a href="https://ash-z01.github.io/">Rubik Cell Space</a></div>
            <div class="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
    	 <main class="main">
          <div class="container">
      		
<article class="post-warp" itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">Recursion of Lambda-Calculus</h1>
        <div class="post-meta">
                Written by <a itemprop="name" href="https://ash-z01.github.io/" rel="author">ash</a> 🐱‍💻 
                <span class="post-time">
                on <time datetime=2020-11-23 itemprop="datePublished">November 23, 2020</time>
                </span>
                in
                <i class="iconfont icon-folder"></i>
                <span class="post-category">
                        <a href="https://ash-z01.github.io/categories/lambda%E5%A5%A5%E7%A7%98/"> Lambda奥秘 </a>
                        
                </span>
        </div>
    </header>
    <div class="post-content">
        

        

        
        
     
          
          
          

          
          
          

          <blockquote>
<p>从前有座山，山里有座庙，庙里有个老和尚，正在给小和尚讲故事呢！故事是什么呢？“从前有座山，山里有座庙，庙里有个老和尚，正在给小和尚讲故事呢！故事是什么呢？‘从前有座山，山里有座庙，庙里有个老和尚，正在给小和尚讲故事呢！故事是什么呢？……’”</p>
</blockquote>
<h2 id="0x01-不动点">0x01 不动点</h2>
<p>定义函数 𝑓:ℝ↦ℝ，如果 ∃𝑥∈𝐷(𝑓)，使得 𝑥=𝑓(𝑥)，则称点 𝑥 是函数 𝑓(𝑥) 的不动点.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-md" data-lang="md">// 等式 x = f(x) 可以进行如下的无穷变换

x = f(x)
  = f(f(x))
  = f(f(f(x)))
  = ...
</code></pre></div><h2 id="0x02-递归">0x02 递归</h2>
<blockquote>
<p>递归的强大之处在于它允许用户用有限的语句描述无限的对象! 瑞士的计算机科学家 <code>尼克劳斯·维尔特</code> 如是说..</p>
</blockquote>
<p>考虑一下 阶乘函数 <code>fact</code> 的定义:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-md" data-lang="md">fact n = 1 if n == 0 else (n <span style="font-style:italic">* fact (n-1))
</span><span style="font-style:italic">
</span><span style="font-style:italic">// 尝试进行 lambda 抽象 [忽略表达式的细节]
</span><span style="font-style:italic">let zero? = lambda n x y . if-then-else (n == 0) x y
</span><span style="font-style:italic">let pred = lambda x . x - 1
</span><span style="font-style:italic">
</span><span style="font-style:italic">fact = lambda n . zero? n 1 (n *</span> fact (pred n))

// 右侧还是有fact，怎么办，再次使用lambda, 把它拽出来试试..

fact = (lambda f . (lambda n . zero? n 1 (n * f (pred n)))) fact

// 看着好乱，抽象一下吧..
F = E(F) // F是fact, E是中间的lambda函数
  = E(E(F)) // 可以无穷替换哎!!!
  = E(E(E(F)))
  = ...
</code></pre></div><p>也就是说, <code>F</code> 是函数 <code>E</code> 的不动点，但是这个函数看着好复杂鸭，我该如何求解呢(这里先不讨论高阶函数的求解方法)~</p>
<h2 id="0x03-传说中的-y组合子">0x03 传说中的 Y组合子</h2>
<p>召唤!! <code>Y组合子</code> !! 一起来瞅瞅这是个啥东东~</p>
<p><code>Y组合子</code> 作为高级函数不动点的 <code>&quot;通用求根公式&quot;</code>，只要函数存在不动点，我们就可以通过 <code>Y组合子</code> 结合函数，进行求解</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-md" data-lang="md">Y(E) = F
     = E(F)      // F = E(F) 
     = E(Y(E))
     = E(E(Y(E)))
</code></pre></div><p>利用 <code>Y组合子</code> 可以求解得到 <code>F</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-md" data-lang="md">F = Y(E)
  = Y(lambda f . (lambda n . zero? n 1 f(n * (pred n))))
</code></pre></div><p>那么这个 <code>Y</code> 到底长啥样呢~ (让我们通过一个有趣的小栗子, 一起推导一下吧~)</p>
<h2 id="0x04-推导-y-组合子编程">0x04 推导 Y 组合子[编程]</h2>
<p>这节我们将从一个常见的函数出发，编程推导出 <code>Y组合子</code> ，不熟悉编程的小伙伴，可以直接跳过，不过我采用的Lua语言简单灵活，很方便阅读理解的，那么开始吧~</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-lua" data-lang="lua"><span style="color:#75715e">--[[
</span><span style="color:#75715e"># Y魔法
</span><span style="color:#75715e"># Y Y = Y (Y Y)
</span><span style="color:#75715e">]]</span>

<span style="color:#66d9ef">local</span> arr1 <span style="color:#f92672">=</span> {<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">5</span>} <span style="color:#75715e">-- Lua中定义的数组(其实是表，不用在意这些细节)</span>

<span style="color:#75715e">--[[
</span><span style="color:#75715e">    这里先定义两个函数,
</span><span style="color:#75715e">    isEmpty 用于判断数组是否为空;
</span><span style="color:#75715e">    shift   用于将数组中第一项元素移除, JS玩家应该很熟悉这个命名吧~
</span><span style="color:#75715e">]]</span>

<span style="color:#66d9ef">local</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">isEmpty</span>(arr)
    <span style="color:#66d9ef">if</span> next(arr) <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span> <span style="color:#66d9ef">then</span>   <span style="color:#75715e">-- 蹩脚的 空表判断 arr == {}, 将就一下吧</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>
<span style="color:#66d9ef">end</span>

<span style="color:#66d9ef">local</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">shift</span>(arr)
    table.remove(arr, <span style="color:#ae81ff">1</span>)   <span style="color:#75715e">-- Lua下标从1开始</span>
    <span style="color:#66d9ef">return</span> arr
<span style="color:#66d9ef">end</span>

<span style="color:#75715e">-- 好的，开始我们的旅程吧~</span>

<span style="color:#75715e">--[[
</span><span style="color:#75715e">* 现在问题来了，我想求解 数组的长度 该怎么做呢?
</span><span style="color:#75715e">]]</span>

<span style="color:#75715e">-- [务实的小伙伴肯定第一时间想到，Lua有没有内建函数或者语法糖，有的话，那就很方便了鸭~]</span>
<span style="color:#75715e">-- 一番检索之后，发现 Lua 还真有</span>
<span style="color:#75715e">-- print(#arr1) -- 哈哈，成功得到了 数组arr 的长度</span>

<span style="color:#75715e">-- 看来大家都能很轻松地应对嘛~  [就这!??]</span>


<span style="color:#75715e">-- 那如果，不允许使用内置语法糖呢??</span>
<span style="color:#75715e">-- [聪明的小伙伴表示: 这也难不倒我~ 看我递归显神通...]</span>
<span style="color:#66d9ef">local</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">rlength</span>(arr)
    <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> rlength(shift(arr))  <span style="color:#75715e">-- 使用了本身的函数名</span>
<span style="color:#66d9ef">end</span>
<span style="color:#75715e">-- print(rlength(arr1))  </span>

<span style="color:#75715e">-- (啪-啪-啪~ 鼓掌声)</span>

<span style="color:#75715e">--[[ 
</span><span style="color:#75715e">    但是!! 你们以为这就完了嘛~?~ too young too naive~
</span><span style="color:#75715e">
</span><span style="color:#75715e">    [我知道！尾调用优化，改成尾递归形式~]
</span><span style="color:#75715e">
</span><span style="color:#75715e">    不不不，不要误会，我不是在一步步刁难各位~
</span><span style="color:#75715e">    我只是发现，函数体内使用着函数本身的名字，想把它去掉而已
</span><span style="color:#75715e">
</span><span style="color:#75715e">    [纳尼！？我看，你就是在刁难我胖虎！！]
</span><span style="color:#75715e">]]</span>

<span style="color:#66d9ef">local</span> lenX <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>(arr)
    <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">end</span>
    <span style="color:#75715e">-- return 1 + ???(shift(arr))</span>
<span style="color:#66d9ef">end</span>


<span style="color:#75715e">--[[
</span><span style="color:#75715e">    先去看点别的
</span><span style="color:#75715e">]]</span>

<span style="color:#75715e">-- 这个函数做啥鸭，好像不断调用自身，永远不会停止!</span>
<span style="color:#66d9ef">local</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">eternity</span>(x)
    <span style="color:#66d9ef">return</span> eternity(x)
<span style="color:#66d9ef">end</span>

<span style="color:#75715e">-- 来看看 这个函数是啥</span>
<span style="color:#66d9ef">local</span> len0 <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>(arr)
    <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> eternity(shift(arr))
<span style="color:#66d9ef">end</span>
<span style="color:#75715e">-- 我们先跨出最小的一步，求解 长度为0 的数组长度</span>
<span style="color:#75715e">-- print(len0({}))</span>


<span style="color:#75715e">-- 那么长度为1 的数组呢</span>
<span style="color:#66d9ef">local</span> len1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>(arr)
    <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> len0(shift(arr))
<span style="color:#66d9ef">end</span>
<span style="color:#75715e">-- print(len1({1}))</span>


<span style="color:#75715e">-- 函数展开一下</span>
len1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span> (arr)
    <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> (<span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> eternity(shift(arr))
    <span style="color:#66d9ef">end</span>)(shift(arr))
<span style="color:#66d9ef">end</span>
<span style="color:#75715e">-- print(len1({1}))</span>


<span style="color:#75715e">-- 好像 很难没有太多启发嘛，那就继续，看看 长度为2 的数组</span>
<span style="color:#66d9ef">local</span> len2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span> (arr)
    <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> len1(shift(arr))
<span style="color:#66d9ef">end</span>
<span style="color:#75715e">-- print(len2({1,2}))</span>

<span style="color:#75715e">-- 继续展开</span>
len2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span> (arr)
    <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> (<span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> (<span style="color:#66d9ef">function</span> (arr)
            <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
                <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
            <span style="color:#66d9ef">end</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> eternity(shift(arr))
        <span style="color:#66d9ef">end</span>)(shift(arr))
    <span style="color:#66d9ef">end</span>)(shift(arr))
<span style="color:#66d9ef">end</span>
<span style="color:#75715e">-- print(len2({1,2}))</span>


<span style="color:#75715e">-- 开始看着有点绕了呢，但是还是没有看出太多端倪呢~</span>
<span style="color:#75715e">-- 前进!!  长度为3 的数组</span>
<span style="color:#66d9ef">local</span> len3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span> (arr)
    <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span> 
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> (<span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> (<span style="color:#66d9ef">function</span> (arr)
            <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
                <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
            <span style="color:#66d9ef">end</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> (<span style="color:#66d9ef">function</span> (arr)
                <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
                    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
                <span style="color:#66d9ef">end</span>
                <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> eternity(shift(arr))
            <span style="color:#66d9ef">end</span>)(shift(arr))
        <span style="color:#66d9ef">end</span>)(shift(arr))
    <span style="color:#66d9ef">end</span>)(shift(arr))
<span style="color:#66d9ef">end</span>
<span style="color:#75715e">-- print(len3({1,2,3}))</span>


<span style="color:#75715e">-- 害，重复代码挺多的，看看能不能提取出来</span>
<span style="color:#75715e">-- 简单一点就从 长度为0 的数组开始吧</span>
len0 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">function</span> (flen)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> flen(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)(eternity)
<span style="color:#75715e">-- print(len0({}))</span>

<span style="color:#75715e">-- 那么 长度为1，2，3的数组 也就明了了</span>
len1 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">function</span> (flen)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> flen(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)(len0)
<span style="color:#75715e">-- print(len1({1}))</span>

len2 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">function</span> (flen)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> flen(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)(len1)
<span style="color:#75715e">-- print(len2({1,2}))</span>

len3 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">function</span> (flen)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> flen(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)(len2)
<span style="color:#75715e">-- print(len3({1,2,3}))</span>


<span style="color:#75715e">-- 感觉看不出啥端倪，继续展开看看</span>
len1 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">function</span> (flen)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> flen(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)((<span style="color:#66d9ef">function</span> (flen)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> flen(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)(eternity))


len2 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">function</span> (flen)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> flen(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)((<span style="color:#66d9ef">function</span> (flen)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> flen(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)((<span style="color:#66d9ef">function</span> (flen)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> flen(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)(eternity)))


len3 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">function</span> (flen)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> flen(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)((<span style="color:#66d9ef">function</span> (flen)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> flen(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)((<span style="color:#66d9ef">function</span> (flen)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> flen(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)((<span style="color:#66d9ef">function</span> (flen)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> flen(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)(eternity))))

<span style="color:#75715e">-- print(len0({}))</span>
<span style="color:#75715e">-- print(len1({1}))</span>
<span style="color:#75715e">-- print(len2({1,2}))</span>
<span style="color:#75715e">-- print(len3({1,2,3}))</span>


<span style="color:#75715e">-- 自己观察一下，好像是 f(f(f(ete))) 这样的模式呢，emmmm... 那么再提取试试</span>
len0 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">function</span> (f)
    <span style="color:#66d9ef">return</span> f(eternity)
<span style="color:#66d9ef">end</span>)(<span style="color:#66d9ef">function</span> (flen)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> flen(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)
<span style="color:#75715e">-- print(len0({}))</span>


<span style="color:#75715e">-- 学废了！！ 长度为1，2，3的数组  依样画葫芦~</span>
len1 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">function</span> (f)
    <span style="color:#66d9ef">return</span> f(f(eternity))
<span style="color:#66d9ef">end</span>)(<span style="color:#66d9ef">function</span> (flen)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> flen(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)
<span style="color:#75715e">-- print(len1({1}))</span>

len2 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">function</span> (f)
    <span style="color:#66d9ef">return</span> f(f(f(eternity)))
<span style="color:#66d9ef">end</span>)(<span style="color:#66d9ef">function</span> (flen)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> flen(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)
<span style="color:#75715e">-- print(len2({1,2}))</span>

len3 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">function</span> (f)
    <span style="color:#66d9ef">return</span> f(f(f(f(eternity))))
<span style="color:#66d9ef">end</span>)(<span style="color:#66d9ef">function</span> (flen)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> flen(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)
<span style="color:#75715e">-- print(len3({1,2,3}))</span>


<span style="color:#75715e">--[[
</span><span style="color:#75715e">   感觉悟出了一些啥，但是还是没有进一步的思路哎~
</span><span style="color:#75715e">   害，既然如此，就搞事情！！
</span><span style="color:#75715e">   eternity函数既然不会执行到, 那就可以随意替换, 比如这样-&gt; [替换自身]
</span><span style="color:#75715e">]]</span>
len0 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">function</span> (f)
    <span style="color:#66d9ef">return</span> f(f)
<span style="color:#66d9ef">end</span>)(<span style="color:#66d9ef">function</span> (flen)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> flen(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)
<span style="color:#75715e">-- print(len0({}))</span>

<span style="color:#75715e">-- emmm~ 心满意足!  再仔细看看，好像flen这个函数名字也可以换一下~ 一家人就是要整整齐齐!~</span>
len0 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">function</span> (f)
    <span style="color:#66d9ef">return</span> f(f)
<span style="color:#66d9ef">end</span>)(<span style="color:#66d9ef">function</span> (f)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> f(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)
<span style="color:#75715e">-- print(len0({}))</span>

<span style="color:#75715e">--  规约一下看看是啥样~</span>
len0 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">function</span> (f)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> f(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)(<span style="color:#66d9ef">function</span> (f)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> f(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)
<span style="color:#75715e">-- print(len0({}))</span>

<span style="color:#75715e">-- 天呐!!! 函数把自己传给了自己~!!!!</span>


<span style="color:#75715e">-- 进一步规约！</span>
len0 <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span> (arr)
    <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> (<span style="color:#66d9ef">function</span> (f)
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
            <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
                <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
            <span style="color:#66d9ef">end</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> f(shift(arr))
        <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">end</span>)(shift(arr))
<span style="color:#66d9ef">end</span>
<span style="color:#75715e">-- print(len0({}))</span>

<span style="color:#75715e">--[[
</span><span style="color:#75715e">    细细揣摩一下, F(F) 构造出的函数Z
</span><span style="color:#75715e">    1. 当传入长度为0的空数组时，返回0   Z({}) =&gt; 0
</span><span style="color:#75715e">    2. Z({1}) =&gt; 1 + 函数F(...)  如果此时这个F 还是 F(F) 呢 =&gt; F(F)(...)
</span><span style="color:#75715e">  
</span><span style="color:#75715e">  想象一下，会发生什么~
</span><span style="color:#75715e">
</span><span style="color:#75715e">]]</span>
<span style="color:#75715e">--</span>

len0 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">function</span> (f)
    <span style="color:#66d9ef">return</span> f(f)
<span style="color:#66d9ef">end</span>)(<span style="color:#66d9ef">function</span> (f)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#75715e">-- return 1 + f(shift(arr))</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> f(f)(shift(arr))  <span style="color:#75715e">-- 注意此处的变化</span>
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)
<span style="color:#75715e">-- print(len0({}))</span>
<span style="color:#75715e">-- print(len0({1,2}))</span>

<span style="color:#75715e">-- 通过不断产生的 F(F)， 不断推迟计算，直至 数组长度为0. </span>

<span style="color:#75715e">-- 这里是不是蕴涵着某种更通用的神秘力量呢~</span>
<span style="color:#75715e">-- 进一步提取</span>
lenX <span style="color:#f92672">=</span> (<span style="color:#66d9ef">function</span> (f)
    <span style="color:#66d9ef">return</span> f(f)
<span style="color:#66d9ef">end</span>)(<span style="color:#66d9ef">function</span> (f)
    <span style="color:#66d9ef">return</span> (<span style="color:#66d9ef">function</span> (length)
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
            <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
                <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
            <span style="color:#66d9ef">end</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> length(shift(arr))
        <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">end</span>)
    <span style="color:#75715e">-- (f(f))          -- call-by-value的求值策略下，避免参数无限求值，导致栈溢出</span>
    (<span style="color:#66d9ef">function</span> (x)
        <span style="color:#66d9ef">return</span> f(f)(x)
    <span style="color:#66d9ef">end</span>)
<span style="color:#66d9ef">end</span>)
<span style="color:#75715e">-- print(lenX({1,2,3,4,5}))</span>


<span style="color:#75715e">-- lenX = (function (f)</span>
<span style="color:#75715e">--     return f(f)</span>
<span style="color:#75715e">-- end)((function (flen)</span>
<span style="color:#75715e">--     return function (f)</span>
<span style="color:#75715e">--         return flen(function (x)</span>
<span style="color:#75715e">--             return f(f)(x)</span>
<span style="color:#75715e">--         end)</span>
<span style="color:#75715e">--     end</span>
<span style="color:#75715e">-- end)(function (length)</span>
<span style="color:#75715e">--     return function (arr)</span>
<span style="color:#75715e">--         if isEmpty(arr) then</span>
<span style="color:#75715e">--             return 0</span>
<span style="color:#75715e">--         end</span>
<span style="color:#75715e">--         return 1 + length(shift(arr))</span>
<span style="color:#75715e">--     end</span>
<span style="color:#75715e">-- end))</span>

<span style="color:#75715e">-- 再提取</span>
lenX <span style="color:#f92672">=</span> (<span style="color:#66d9ef">function</span> (flen)
    <span style="color:#66d9ef">return</span> (<span style="color:#66d9ef">function</span> (f)
        <span style="color:#66d9ef">return</span> f(f)
    <span style="color:#66d9ef">end</span>)(<span style="color:#66d9ef">function</span> (f)
        <span style="color:#66d9ef">return</span> flen(<span style="color:#66d9ef">function</span> (x)
            <span style="color:#66d9ef">return</span> f(f)(x)
        <span style="color:#66d9ef">end</span>)
    <span style="color:#66d9ef">end</span>)
<span style="color:#66d9ef">end</span>)(<span style="color:#66d9ef">function</span> (length)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> length(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)
<span style="color:#75715e">-- print(lenX({1,2,3,4,5}))</span>

<span style="color:#75715e">-- OK, 到了这里就差不多了，观察一下函数形式  F = Y(E)</span>
<span style="color:#75715e">-- 提取Y函数</span>

Y <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span> (f)
    <span style="color:#66d9ef">return</span> (<span style="color:#66d9ef">function</span> (u)
        <span style="color:#66d9ef">return</span> u(u)
    <span style="color:#66d9ef">end</span>)(<span style="color:#66d9ef">function</span> (u)
        <span style="color:#66d9ef">return</span> f(<span style="color:#66d9ef">function</span> (x)
            <span style="color:#66d9ef">return</span> u(u)(x)
        <span style="color:#66d9ef">end</span>)
    <span style="color:#66d9ef">end</span>)
<span style="color:#66d9ef">end</span>

<span style="color:#66d9ef">local</span> final_len <span style="color:#f92672">=</span> Y(<span style="color:#66d9ef">function</span> (length)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (arr)
        <span style="color:#66d9ef">if</span> isEmpty(arr) <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> length(shift(arr))
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)

<span style="color:#75715e">-- print(final_len({1,2,3,4,5}))</span>

<span style="color:#75715e">--[[
</span><span style="color:#75715e">    有了Y函数，我们就能很方便地处理匿名递归
</span><span style="color:#75715e">]]</span>

<span style="color:#75715e">-- 阶乘函数[递归形式]</span>
<span style="color:#66d9ef">local</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">fact</span>(n)
    <span style="color:#66d9ef">if</span> n <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">then</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">return</span> n <span style="color:#f92672">*</span> fact(n <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)
<span style="color:#66d9ef">end</span>
<span style="color:#75715e">-- print(fact(4))</span>


<span style="color:#75715e">-- 阶乘函数[匿名递归]</span>
<span style="color:#66d9ef">local</span> anon_fact <span style="color:#f92672">=</span> Y(<span style="color:#66d9ef">function</span> (fact)
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> (n)
        <span style="color:#66d9ef">if</span> n <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">then</span>
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>
        <span style="color:#66d9ef">end</span>
        <span style="color:#66d9ef">return</span> n <span style="color:#f92672">*</span> fact(n <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>)
<span style="color:#75715e">-- print(anon_fact(5))</span>


<span style="color:#75715e">--[[
</span><span style="color:#75715e">    [所以这个Y函数到底是啥呢??] 
</span><span style="color:#75715e">    在这里，我们可以称为 -&gt; [应用序]Y组合子
</span><span style="color:#75715e">]]</span>
</code></pre></div><h2 id="0x05-终于见到-y">0x05 终于见到 Y</h2>
<p>经过上面的编程推演, 最终得到了 <code>Y组合子</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-md" data-lang="md">Y = λf.(λx.(f (x x)) λx.(f (x x)))  // Call-By-Name
Y = λf.((λu.(u u)) λx.(f λv.(x x v))) // Call-By-Value
</code></pre></div><p>最后用一个例子函数g来展开它，可以看到这个函数是如何成为一个不动点组合子的.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-md" data-lang="md">(Y g)
    = (λf.(λx.(f (x x)) λx.(f (x x))) g) // 展开
    = (λx.(g (x x)) λx.(g (x x))) // λf的β-归约 - 应用主函数于g
    = (λy.(g (y y)) λx.(g (x x)))// α-转换 - 重命名约束变量
    = (g (λx.(g (x x)) λx.(g (x x)))) // λy的β-归约 - 应用左侧函数于右侧函数
    = (g (Y g)) // Y的定义
</code></pre></div><h2 id="0x06-参考">0x06 参考</h2>
<ul>
<li><a href="https://zh.wikipedia.org/wiki/%E5%93%88%E6%96%AF%E5%87%AF%E5%B0%94%C2%B7%E6%9F%AF%E9%87%8C">wiki - 哈斯凯尔·柯里</a></li>
<li><a href="https://mitpress.mit.edu/books/little-schemer-fourth-edition">book - TheLittleSchemer</a></li>
<li><a href="...">paper - Programming Languages and Lambda Calculi</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%E9%80%92%E5%BD%92">wiki - 递归</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%CE%9B%E6%BC%94%E7%AE%97">wiki - λ演算</a></li>
<li><a href="http://goodmath.blogspot.com/">blog - Good Math/Bad Math</a></li>
<li><a href="https://www.slideshare.net/yinwang0/reinventing-the-ycombinator">share - 王垠</a></li>
<li><a href="...">paper - The Theory of Recursive Functions, Approaching its Centennial</a></li>
<li><a href="...">paper - 谈谈 lambda</a></li>
<li><a href="...">paper - History of Lambda-calculus and Combinatory Logic</a></li>
</ul>

    </div>

    <div class="post-copyright">
             
            <p class="copyright-item">
                <span>Author:</span>
                <span>ash </span>
                </p>
            
           
             
            <p class="copyright-item">
                    <span>Link:</span>
                    <a href=https://ash-z01.github.io/2020/recursion/>https://ash-z01.github.io/2020/recursion/</span>
            </p>
            
             
            <p class="copyright-item lincese">
                本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可
            </p>
            
    </div>

  
    <div class="post-tags">
        
            <section>
            <i class="iconfont icon-tag"></i>Tag(s): 
            
            <span class="tag"><a href="https://ash-z01.github.io/tags/lambda/">
                    #Lambda</a></span>
            
            <span class="tag"><a href="https://ash-z01.github.io/tags/%CE%BB/">
                    #λ</a></span>
            
            <span class="tag"><a href="https://ash-z01.github.io/tags/%CE%BB-%E6%BC%94%E7%AE%97/">
                    #λ-演算</a></span>
            
            </section>
        
        <section>
                <a href="javascript:window.history.back();">back</a></span> · 
                <span><a href="https://ash-z01.github.io/">home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="https://ash-z01.github.io/2020/boolandcondition/" class="prev" rel="prev" title="Bool and Condition of Lambda-Calculus"><i class="iconfont icon-left"></i>&nbsp;Bool and Condition of Lambda-Calculus</a>
         
        
        <a href="https://ash-z01.github.io/2021/cap/" class="next" rel="next" title="CP or AP?">CP or AP?&nbsp;<i class="iconfont icon-right"></i></a>
        
    </div>

    <div class="post-comment">
          
                 
          
    </div>
</article>
          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2020 - 2021</span>
        
        <span class="with-ash">
        
        🚀
         </span>
         
            <span class="author" itemprop="copyrightHolder"><a href="https://ash-z01.github.io/">ash</a> | </span> 
         

         
		  <span>Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow">Hugo</a> & <a href="https://github.com/liuzc/leaveit" target="_blank" rel="external nofollow">LeaveIt</a></span> 
    </div>
</footer>












    
    
    <script src="/js/vendor_no_gallery.min.js" async=""></script>
    
  



     </div>
  </body>
</html>
